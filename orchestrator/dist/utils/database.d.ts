/**
 * Database Configuration and Connection Management
 * Handles PostgreSQL connection pool and lifecycle
 */
import { Pool, PoolClient } from 'pg';
export declare class DatabaseConfig {
    private static instance;
    static getPool(): Pool;
    static initialize(): Promise<void>;
    static shutdown(): Promise<void>;
    static query(text: string, values?: any[]): Promise<any>;
    static getClient(): Promise<PoolClient>;
}
/**
 * Schema migrations and initialization
 */
export declare const INIT_SCHEMA = "\n-- Workflows table\nCREATE TABLE IF NOT EXISTS workflows (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  status VARCHAR(50) NOT NULL DEFAULT 'created',\n  title VARCHAR(255) NOT NULL,\n  description TEXT,\n  requirements JSONB NOT NULL,\n  execution_plan JSONB,\n  created_at TIMESTAMP DEFAULT NOW(),\n  started_at TIMESTAMP,\n  completed_at TIMESTAMP,\n  created_by VARCHAR(255),\n  result JSONB,\n  version INTEGER DEFAULT 1\n);\n\n-- Tasks table\nCREATE TABLE IF NOT EXISTS tasks (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  workflow_id UUID NOT NULL REFERENCES workflows(id) ON DELETE CASCADE,\n  agent_type VARCHAR(50) NOT NULL,\n  title VARCHAR(255) NOT NULL,\n  description TEXT,\n  status VARCHAR(50) NOT NULL DEFAULT 'pending',\n  priority VARCHAR(20) NOT NULL DEFAULT 'medium',\n  created_at TIMESTAMP DEFAULT NOW(),\n  started_at TIMESTAMP,\n  completed_at TIMESTAMP,\n  estimated_duration_ms INTEGER,\n  actual_duration_ms INTEGER,\n  retry_count INTEGER DEFAULT 0,\n  max_retries INTEGER DEFAULT 3,\n  error TEXT,\n  result JSONB,\n  dependencies TEXT[] DEFAULT '{}',\n  metadata JSONB DEFAULT '{}',\n  version INTEGER DEFAULT 1\n);\n\n-- Artifacts table\nCREATE TABLE IF NOT EXISTS artifacts (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  task_id UUID NOT NULL REFERENCES tasks(id) ON DELETE CASCADE,\n  type VARCHAR(50) NOT NULL,\n  path VARCHAR(1024) NOT NULL,\n  content TEXT NOT NULL,\n  size INTEGER NOT NULL,\n  checksum VARCHAR(64),\n  created_at TIMESTAMP DEFAULT NOW()\n);\n\n-- Agents table\nCREATE TABLE IF NOT EXISTS agents (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  agent_type VARCHAR(50) NOT NULL UNIQUE,\n  name VARCHAR(255) NOT NULL,\n  status VARCHAR(50) NOT NULL DEFAULT 'idle',\n  workers INTEGER DEFAULT 3,\n  available_workers INTEGER DEFAULT 3,\n  current_tasks UUID[] DEFAULT '{}',\n  completed_tasks INTEGER DEFAULT 0,\n  failed_tasks INTEGER DEFAULT 0,\n  last_health_check TIMESTAMP DEFAULT NOW(),\n  capabilities JSONB,\n  configuration JSONB,\n  updated_at TIMESTAMP DEFAULT NOW()\n);\n\n-- Queue messages table\nCREATE TABLE IF NOT EXISTS queue_messages (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  type VARCHAR(100) NOT NULL,\n  source_id VARCHAR(255) NOT NULL,\n  destination_id VARCHAR(255),\n  payload JSONB NOT NULL,\n  priority VARCHAR(20) NOT NULL DEFAULT 'medium',\n  created_at TIMESTAMP DEFAULT NOW(),\n  processed_at TIMESTAMP,\n  retry_count INTEGER DEFAULT 0,\n  status VARCHAR(50) DEFAULT 'pending'\n);\n\n-- File changes table\nCREATE TABLE IF NOT EXISTS file_changes (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  file_path VARCHAR(1024) NOT NULL,\n  change_type VARCHAR(50) NOT NULL,\n  previous_hash VARCHAR(64),\n  current_hash VARCHAR(64),\n  is_significant BOOLEAN DEFAULT FALSE,\n  change_category VARCHAR(100),\n  affected_features TEXT[] DEFAULT '{}',\n  timestamp TIMESTAMP DEFAULT NOW(),\n  version INTEGER DEFAULT 1\n);\n\n-- Quality gate results table\nCREATE TABLE IF NOT EXISTS quality_gate_results (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  task_id UUID REFERENCES tasks(id) ON DELETE CASCADE,\n  gate_name VARCHAR(255) NOT NULL,\n  passed BOOLEAN NOT NULL,\n  score INTEGER,\n  errors JSONB DEFAULT '[]',\n  warnings JSONB DEFAULT '[]',\n  details JSONB,\n  executed_at TIMESTAMP DEFAULT NOW(),\n  execution_time_ms INTEGER\n);\n\n-- Workflow metrics table\nCREATE TABLE IF NOT EXISTS workflow_metrics (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  workflow_id UUID NOT NULL REFERENCES workflows(id) ON DELETE CASCADE,\n  total_duration_ms INTEGER,\n  total_cost_usd NUMERIC(10, 4),\n  total_tokens_used INTEGER,\n  quality_score INTEGER,\n  timestamp TIMESTAMP DEFAULT NOW()\n);\n\n-- Logs table\nCREATE TABLE IF NOT EXISTS logs (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  timestamp TIMESTAMP DEFAULT NOW(),\n  level VARCHAR(20) NOT NULL,\n  component VARCHAR(255) NOT NULL,\n  message TEXT NOT NULL,\n  context JSONB,\n  error TEXT,\n  INDEX idx_timestamp (timestamp),\n  INDEX idx_component (component),\n  INDEX idx_level (level)\n);\n\n-- Indexes for performance\nCREATE INDEX IF NOT EXISTS idx_workflows_status ON workflows(status);\nCREATE INDEX IF NOT EXISTS idx_workflows_created_at ON workflows(created_at);\nCREATE INDEX IF NOT EXISTS idx_tasks_workflow_id ON tasks(workflow_id);\nCREATE INDEX IF NOT EXISTS idx_tasks_status ON tasks(status);\nCREATE INDEX IF NOT EXISTS idx_tasks_agent_type ON tasks(agent_type);\nCREATE INDEX IF NOT EXISTS idx_artifacts_task_id ON artifacts(task_id);\nCREATE INDEX IF NOT EXISTS idx_queue_messages_status ON queue_messages(status);\nCREATE INDEX IF NOT EXISTS idx_file_changes_timestamp ON file_changes(timestamp);\nCREATE INDEX IF NOT EXISTS idx_quality_results_task_id ON quality_gate_results(task_id);\n";
export declare function initializeDatabase(): Promise<void>;
//# sourceMappingURL=database.d.ts.map